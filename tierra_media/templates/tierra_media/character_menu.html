{% extends 'base.html' %}
{% block title %}
    Menú de {{ character.name }}
{% endblock %}
{% block script %}
    <script defer>
        document.addEventListener('DOMContentLoaded', function () {
            let alerts = document.querySelectorAll('.alert');

        alerts.forEach(function(alert) {
            setTimeout(function() {
                alert.classList.remove('show');
                alert.classList.add('fade');
            }, 2000);

            setTimeout(function() {
                alert.remove();
            }, 2500);
        });
    });
    </script>
{% endblock %}
{% block content %}
    {% if messages %}
    	{% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show d-flex justify-content-center col-4" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    {% if character %}
        <ul>
            <li><a href="{% url 'tierra_media:equip_objects' character.id %}" class="text-decoration-none">Equipar objetos</a></li>
            <li><a href="{% url 'tierra_media:encounter' character.id %}" class="text-decoration-none">Comprobar encuentros cercanos</a></li>
            <li><a href="{% url 'tierra_media:move' character.id %}" class="text-decoration-none">Mover personaje</a></li>
            <li><a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#relationshipsModal">Mostrar relaciones</a></li>
            <li><a href="{% url 'tierra_media:shop' character.id %}" class="text-decoration-none">Tienda</a></li>
            <li><a href="{% url 'tierra_media:index' %}" class="text-decoration-none">Cambiar de personaje</a></li>
        </ul>
        <ul>
            <li>Nombre: {{ character.name }}</li>
            <li>Vida: {{ character.health }}/{{ character.max_health }}</li>
            <li>Defensa: {{ character.defense }}</li>
            <li>Localización: {{ character.location.name}}</li>
            <li>Raza: {{ character.race.name }}</li>
            <li>Arma equipada: {{ character.equipped_weapon.name }}</li>
            <ul>
                <li>Daño: {{ character.equipped_weapon.damage }}</li>
                <li>Tipo: {{ character.equipped_weapon.type }}</li>
            </ul>
            <li>Armadura equipada: {{ character.equipped_armor.name }}</li>
            <ul>
                <li>Defensa: {{ character.equipped_armor.defense }}</li>
            </ul>
        </ul>


        <!--Modal que muestra las relaciones-->
        <div class="modal fade" id="relationshipsModal" tabindex="-1" aria-labelledby="relationshipsModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="relationshipsModalLabel">Relaciones de {{ character.name }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h6>Aliados: </h6>
                        <ul>
                            {% if relationships.allies %}
                                {% for ally in relationships.allies %}
                                    <li>{{ ally.name }}</li>
                                {% endfor %}
                            {% else %}
                                <li>Este personaje no tiene aliados.</li>
                            {% endif %}
                        </ul>

                        <h6>Enemigos: </h6>
                        <ul>
                            {% if relationships.enemies %}
                                {% for enemy in relationships.enemies %}
                                    <li>{{ enemy.name }}</li>
                                {% endfor %}
                            {% else %}
                                <li>Este personaje no tiene enemigos.</li>
                            {% endif %}
                        </ul>

                        <h6>Neutrales: </h6>
                        <ul>
                            {% if relationships.neutrals %}
                                {% for neutral in relationships.neutrals %}
                                    <li>{{ neutral.name }}</li>
                                {% endfor %}
                            {% else %}
                                <li>Este personaje no tiene neutrales.</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}